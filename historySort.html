<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LM search__history record by CATEGORY</title>
    <meta name="description" content="LM search" />
    <link rel="icon" type="image/ico" href="03_256x256.ico" sizes="192x192">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js" type="text/javascript"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.10.3/sweetalert2.css" />
     <script>
        var jQuery_ = $.noConflict();
        $(function () {
            let dialogH = 0;
            let dialogW = 0;
            let dialogL = 0;
            let dialogT = 0;
            if (over == 1) {
                dialogH = $(document.body).outerHeight(true);
                dialogW = $(document.body).outerWidth(true);
            }
            else {
                switch (showSeat) {
                    case '7':
                        dialogL = 0;
                        dialogT = 0;
                        break;
                    case '8':
                        dialogL = (document.body.clientWidth) / 2;
                        daialogT = 0;
                        break;
                    case '9':
                        dialogL = document.body.clientWidth;
                        dialogT = 0;
                        break;
                    case '4':
                        dialogL = 0;
                        dialogT = (document.body.clientHeight) / 2;
                        break;
                    case '5':
                        dialogL = (document.body.clientWidth) / 2;
                        dialogT = (document.body.clientHeight) / 2;
                        break;
                    case '6':
                        dialogL = document.body.clientWidth;
                        dialogT = (document.body.clientHeight) / 2;
                        break;
                    case '1':
                        dialogL = 0;
                        dialogT = document.body.clientHeight;
                        break;
                    case '2':
                        dialogL = (document.body.clientWidth) / 2;
                        dialogT = document.body.clientHeight;
                        break;
                    case '3':
                        dialogL = document.body.clientWidth;
                        dialogT = document.body.clientHeight;
                        break;
                }
            }

            jQuery_("#dialogDiv").dialog({
                left: dialogL,
                top: dialogT,
                width: dialogW,
                height: dialogH,
                modal: true,
                draggable: false,
                autoOpen: false,
                buttons: {
                    "Ok": function () {
                        jQuery_(this).dialog("close");
                        var ans = $("#Respond").val();
                        console.log(ans);
                        if (ans == 2) {
                            fiveMinutes();
                        }
                    }
                }
            });
        });

    </script>
    <style>
        .logol {
            position: absolute;
            z-index: 4;
        }

        #showLog {
            /* background:white; */
            position: absolute;
            z-index: 4;
            text-shadow:
                -1px -1px 0 #000,
                1px -1px 0 #000,
                -1px 1px 0 #000,
                1px 1px 0 #000,
                2px 2px 2px black;
            color: white;
            box-shadow: black;
            display: flex;
            flex-wrap: wrap;
            font-size: 30px;
            font-weight: bold;
        }

        /*跳通知*/
        div.ui-dialog-titlebar {
            /*改title*/
            background: rgb(209, 61, 12);
            color: rgb(13, 14, 13);
            font-weight: normal;
        }

        .ui-dialog {
            /*改中間*/
            background: rgb(239, 151, 27);
        }

        .ui-dialog h1 {
            /*字*/
            color: rgb(10, 10, 10);
            font-family: fantasy;
            font-size: larger;
        }

        img {
            width: 100px;
            height: 100px;
            float: left;
        }

        #Respond {
            /*下拉選單*/
            background: rgb(241, 203, 11);
            position: absolute;
            right: 10%;
            bottom: 50%;
            float: right;
        }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js" type="text/javascript"></script>
    <link rel="icon" type="image/ico" href="03_256x256.ico" sizes="192x192">
</head>

<body>
    <h1 class="logol"><a href="search.html"><span style="color:crimson;">L</span><span
                style="color: rgb(57, 150, 243);">M</span><span style="color: goldenrod;"> Search</span></a></h1>
    <div id="showLog"></div>

    <div id="dialog" title="Basic dialog">
        <h1>重要通知!!</h1>
        <select id="Respond">
            <option value="1">我知道了</option>
            <option value="2">5分鐘後再說</option>
        </select>
        <img src="03.png">
    </div>
    
    <!--引用sweetAlert2  jQuery-->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" type="text/javascript"></script>
    <!--引用SweetAlert2.js-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.10.3/sweetalert2.js"
        type="text/javascript"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js" type="text/javascript"></script>
        <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
        <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
        <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#Respond").hide();
            $(".ui-dialog").hide();
            initial();
            StartTime();
            let userId = sessionStorage.getItem('LM-UserId');
            /**/
            userId = 1;
            /**/
            if (userId <= 0) {
                alert("系統錯誤 \u2620");
            }
            else {
                let cmd = {};
                cmd["act"] = "showLog";
                cmd["userId"] = userId;
                $.post("index.php", cmd, function (data) {
                    data = JSON.parse(data);
                    if (data.statue == false) {
                        alert("沒有歷史紀錄喔");
                    }
                    else {
                        let content = '';
                        for (let i in data.data) {
                            let a = "red",
                                b = "green",
                                c = "yellow",
                                word = data.data[i].keyword;
                            if (word.match(/[^\u4e00-\u9fa5]/)) {
                                content += '<div class="log" key="' + /*word*/"我我我" + '" style="background-color:' + a + ' > ';

                            }
                            else if (word.match(/[^a-z^A-Z]/g)) {
                                content += '<div class="log" key="' + /*word*/ "ABCD" + '" style="background-color:' + b + ' > ';
                            }
                            else {
                                content += '<div class="log" key="' + /*word*/ "我我我ABCD" + '" style="background-color:' + c + ' > ';

                            }
                            content += '<span style="font-size:30px; font-weight:bold">' + word + '</span><br>';
                            content += '&nbsp;&nbsp;&nbsp;&nbsp;' + data.data[i].time + "</div>";
                        }
                        $("#showLog").append(content);
                    }
                });
            }
            $("body").on("click", ".log", function () {
                leftKeyword($(this).attr("key")); // local storage
                window.location.href = "search.html";
            });
        });
        function initial() {
            $("#showLog").children().remove();
            $("#Respond").hide();
            $(".ui-dialog").hide();
        }
        function leftKeyword(key) {
            sessionStorage.setItem("LM-keyword", key);
        }

        function StartTime() {  /*抓取目前時間*/
            let today = new Date();
            let hour = today.getHours();
            let minute = today.getMinutes();
            let second = today.getSeconds();
            minute = CheckTime(minute);
            second = CheckTime(second);
            hour = CheckTime(hour);
            for (let z = 0; z < arr.length; z++) {
                if (hour == arr[z].substring(0, 2) && minute == arr[z].sustring(2, 4) && second == '00') {  /*設定的時間*/
                    $("#dialogDiv").dialog("open");
                    dialogAlarm.innerHTML = arr[z].substr(4);
                }
            }
            setTimeout(StartTime, 1000);
        }

        function CheckTime(i) {  /*時間<10 前面補0*/
            if (i < 10) {
                i = '0' + i;
            }
            return i;
        }
       /* var jQuery_1_9_1 = $.noConflict();
        $(function () {
            jQuery_1_9_1("#dialog").dialog({
                height:$(document.body).outerHeight(true),
                width: $(document.body).outerWidth(true),
                modal: false, //鎖住頁面
                buttons: {
                    Ok: function () {
                        jQuery_1_9_1(this).dialog("close");
                        var ans = $("#Respond").val();
                        console.log(ans);
                        if (ans == 2) {
                            fiveMinutes();
                        }
                    }
                }
            });
        });*/
        function fiveMinutes() {
            /*分 = 分 +5 ;*/
            arr[z].sustring(2, 4) = parseInt(arr[z].sustring(2, 4))+5;
            StartTime();
        }

    </script>
</body>

</html>